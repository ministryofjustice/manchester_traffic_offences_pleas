{"version":3,"sources":["bind.js","trim.js","moj.Conditional.js","moj.Details.js","moj.ExternalLinksTracker.js","moj.PromptOnChange.js","moj.SelectionButtons.js","moj.TemplatedElement.js","moj.focusEvents.js","application.js"],"names":["Function","prototype","bind","oThis","this","TypeError","aArgs","Array","slice","call","arguments","fToBind","fNOP","fBound","apply","concat","String","trim","rtrim","replace","window","moj","Modules","Events","$","Conditional","$el","options","init","defaults","settings","extend","cacheElements","addAriaAttributes","bindEvents","$conditional","$inputs","data","self","on","toggle","conditionalId","attr","not","each","i","currentAttribute","getInputValue","$input","filter","val","find","currentValue","testExpression","RegExp","match","show","removeAttr","removeProp","hide","prop","_Conditional","Details","addClass","text","prependTo","isOpera","Object","toString","opera","openText","$details","closedText","$summaryText","updateState","$summary","$content","$icon","id","index","role","aria-controls","aria-expanded","aria-hidden","aria-live","off","click.details","event","preventDefault","toggleContent","keydown.details","keyCode","click","hasClass","removeClass","toggleClass","_Details","ExternalLinksTracker","eventCategory","eventAction","document","location","pathname","ga","$links","sendGAEvent","href","target","hitCallback","openLink","test","open","_ExternalLinksTracker","PromptOnChange","message","enable","initMetaRefresh","hashedFields","hashFields","disable","runCheck","serialize","fieldsHaveChanged","isEnabled","isMetaRefresh","metaRefreshAt","now","Date","getTime","refreshTag","length","refreshTimeoutLength","parseInt","_PromptOnChange","SelectionButtons","change","is","closest","focus","blur","trigger","TemplatedElement","template","defaultsFor","originalText","eq","$element","updateText","getCurrentValue","$currentSelection","parent","formatValue","value","toLowerCase","getText","populateTemplate","_TemplatedElement","jQuery","fx","remove"],"mappings":"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","file":"application.js","sourcesContent":["/**\n * Polyfill for browsers not supporting native bind()\n *\n * https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Global_objects/Function/bind\n */\n if (!Function.prototype.bind) {\n   Function.prototype.bind = function(oThis) {\n     if (typeof this !== 'function') {\n       // closest thing possible to the ECMAScript 5\n       // internal IsCallable function\n       throw new TypeError('Function.prototype.bind - what is trying to be bound is not callable');\n     }\n\n     var aArgs   = Array.prototype.slice.call(arguments, 1),\n         fToBind = this,\n         fNOP    = function() {},\n         fBound  = function() {\n           return fToBind.apply(this instanceof fNOP\n                  ? this\n                  : oThis,\n                  aArgs.concat(Array.prototype.slice.call(arguments)));\n         };\n\n     fNOP.prototype = this.prototype;\n     fBound.prototype = new fNOP();\n\n     return fBound;\n   };\n }\n","/**\n * Polyfill for browsers not supporting native trim()\n *\n * https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Global_Objects/String/trim\n */\n if (!String.prototype.trim) {\n   (function() {\n     // Make sure we trim BOM and NBSP\n     var rtrim = /^[\\s\\uFEFF\\xA0]+|[\\s\\uFEFF\\xA0]+$/g;\n     String.prototype.trim = function() {\n       return this.replace(rtrim, '');\n     };\n   })();\n }\n","/**\n * Conditional form elements reveal\n *\n * Reveal content based on value of related field\n *\n * -----------------------------------------------------------------------\n * Usage:\n *\n * <input type=\"radio\" name=\"trigger_name\" value=\"regex\">\n * <input type=\"radio\" name=\"trigger_name\" value=\"another value\">\n * <div id=\"target_id\" data-conditional=\"trigger_name\" data-conditional-value=\"^regex$\">...</div>\n */\n\n(function() {\n  'use strict';\n\n  window.moj = window.moj || { Modules: {}, Events: $({}) };\n\n  var Conditional = function($el, options) {\n    this.init($el, options);\n    return this;\n  };\n\n  Conditional.prototype = {\n    defaults: {},\n\n    init: function($el, options) {\n      this.settings = $.extend({}, this.defaults, options);\n      this.cacheElements($el);\n      this.addAriaAttributes();\n      this.bindEvents();\n    },\n\n    cacheElements: function($el) {\n      this.$conditional = $el;\n      this.$inputs = $('[name=\"' + $el.data('conditional') + '\"]');\n    },\n\n    bindEvents: function() {\n      var self = this;\n      this.$inputs\n        .on('change.Conditional', function() {\n          self.toggle();\n        });\n      moj.Events\n        .on('render.Conditional', function() {\n          self.toggle();\n        });\n    },\n\n    addAriaAttributes: function() {\n      var conditionalId = this.$conditional.attr('id');\n      this.$inputs.not('[aria-controls*=' + conditionalId + ']').each(function() {\n        $(this).attr('aria-controls', function(i, currentAttribute) {\n          return currentAttribute ? currentAttribute + ' ' + conditionalId : conditionalId;\n        });\n      });\n      this.$conditional.attr('aria-live', 'polite');\n    },\n\n    getInputValue: function($input) {\n      switch($input.attr('type')) {\n        case \"radio\":\n          return $('[name=\"' + $input.attr('name') + '\"]:checked').attr('value');\n\n        case \"checkbox\":\n          return $input.filter(':checked').val();\n\n        default:\n          return $input.val() || $input.find(':selected').attr('value');\n      }\n    },\n\n    toggle: function() {\n      var currentValue = this.getInputValue(this.$inputs),\n          testExpression = new RegExp(this.$conditional.data('conditionalValue'));\n\n      if (currentValue && currentValue.match(testExpression)) {\n        this.$conditional\n          .show()\n          .attr('aria-expanded', 'true')\n          .removeAttr('aria-hidden')\n          .removeProp('hidden');\n      }\n      else {\n        this.$conditional\n          .hide()\n          .attr('aria-expanded', 'false')\n          .attr('aria-hidden', 'true')\n          .prop('hidden', true);\n      }\n    }\n  };\n\n  moj.Modules._Conditional = Conditional;\n\n  moj.Modules.Conditional = {\n    init: function() {\n      return $('[data-conditional]').each(function() {\n        $(this).data('Conditional', new Conditional($(this), $(this).data()));\n      });\n    }\n  };\n\n}());\n","/**\n * Details Element\n *\n * Replicate <details> functionality that's entirely cross-browser\n * compatible and offers options to update text depending on state\n *\n * -----------------------------------------------------------------------\n * Usage:\n *\n * <div class=\"js-Details [open]\" data-summary-open=\"Alternative text\">\n *   <a class=\"details-trigger\" href=\"#details-content\"><span class=\"summary\">View details</span></a>\n *   <div class=\"details-content\" id=\"details-content\">\n *     Content here\n *   </div>\n * </div>\n *\n * If summaryOpen is set, the summary text is replaced when open. Copy in markup\n * should always be for the closed state.\n */\n(function() {\n  \"use strict\";\n\n  window.moj = window.moj || { Modules: {}, Events: $({}) };\n\n  var Details = function($el, options) {\n    this.init($el, options);\n    return this;\n  };\n\n  Details.prototype = {\n\n    init: function($el, options) {\n\n      $(\"<i>\").addClass(\"arrow arrow-closed\").text(\"\\u25ba\").prependTo($('.details-trigger', $el));\n\n      this.cacheElements($el);\n      this.addAriaAttributes();\n      this.bindEvents();\n\n      this.isOpera = Object.prototype.toString.call(window.opera) == \"[object Opera]\";\n\n      this.openText = this.$details.data(\"summary-open\");\n      this.closedText = this.$summaryText.text();\n\n      this.updateState();\n    },\n\n    cacheElements: function($el) {\n      this.$details = $el;\n      this.$summary = $(\".details-trigger\", $el);\n      this.$summaryText = $(\".summary\", this.$summary);\n      this.$content = $(\".details-content\", $el);\n      this.$icon = $(\"i.arrow\", this.$summary);\n    },\n\n    addAriaAttributes: function() {\n      var id = this.$content.attr(\"id\");\n\n      if (!id) {\n        id = \"js-details-\" + this.$details.index(\".js-Details\");\n        this.$content.attr(\"id\", id);\n      }\n\n      this.$summary.attr({\n        \"role\": \"button\",\n        \"aria-controls\": id,\n        \"aria-expanded\": \"false\"\n      });\n\n      this.$content.attr({\n        \"aria-hidden\": \"true\",\n        \"aria-live\": \"polite\"\n      });\n    },\n\n    bindEvents: function() {\n      var self = this;\n\n      this.$summary.off(\"click.details keydown.details\").on({\n        \"click.details\": function(event) {\n          event.preventDefault();\n          self.toggleContent();\n        },\n        \"keydown.details\": function(event) {\n          if (event.keyCode == 32 || (event.keyCode == 13 && !self.isOpera)) {\n            event.preventDefault();\n            self.$summary.click();\n          }\n        }\n      });\n    },\n\n    updateState: function() {\n      if (this.$details.hasClass(\"open\")) {\n        this.$summary.attr(\"aria-expanded\", \"true\");\n        this.$content.show().removeAttr(\"aria-hidden\").removeProp('hidden');\n        this.$icon.removeClass(\"arrow-closed\").addClass(\"arrow-open\").text(\"\\u25bc\");\n\n        if (this.openText) {\n          this.$summaryText.text(this.openText);\n        }\n      }\n      else {\n        this.$summary.attr(\"aria-expanded\", \"false\");\n        this.$content.hide().attr(\"aria-hidden\", \"true\").prop(\"hidden\", true);\n        this.$icon.removeClass(\"arrow-open\").addClass(\"arrow-closed\").text(\"\\u25ba\");\n\n        if (this.openText) {\n          this.$summaryText.text(this.closedText);\n        }\n      }\n    },\n\n    toggleContent: function() {\n      this.$details.toggleClass(\"open\");\n      this.updateState();\n    }\n  };\n\n  moj.Modules._Details = Details;\n\n  moj.Modules.Details = {\n    init: function() {\n      return $(\".js-Details\").each(function() {\n        $(this).data(\"Details\", new Details($(this), $(this).data()));\n      });\n    }\n  };\n\n}());\n","(function() {\n  \"use strict\";\n\n  window.moj = window.moj || { Modules: {}, Events: $({}) };\n\n  var ExternalLinksTracker = function($el, options) {\n    this.init($el, options);\n    return this;\n  };\n\n  ExternalLinksTracker.prototype = {\n    defaults: {\n      \"eventCategory\": \"External links\",\n      \"eventAction\": document.location.pathname\n    },\n\n    init: function($el, options) {\n      if (typeof ga === \"undefined\") return;\n\n      this.settings = $.extend({}, this.defaults, options);\n      this.cacheElements($el);\n      this.bindEvents();\n    },\n\n    cacheElements: function($el) {\n      this.$links = $el;\n    },\n\n    bindEvents: function() {\n      var self = this;\n\n      this.$links.on('click', function(event) {\n        event.preventDefault();\n        self.sendGAEvent($(this));\n      });\n    },\n\n    sendGAEvent: function($el) {\n      var self = this,\n          href = $el.attr(\"href\"),\n          target = $el.attr(\"target\");\n\n      ga(\"send\",\n         \"event\",\n         self.settings.eventCategory,\n         href,\n         self.settings.eventAction,\n         {\"hitCallback\": self.openLink(href, target)}\n      );\n    },\n\n    openLink: function(href, target) {\n      if (target && !/^_(self|parent|top)$/i.test(target)) {\n        window.open(href, target);\n      }\n      else {\n        window.location.href = href;\n      }\n    }\n  };\n\n  moj.Modules._ExternalLinksTracker = ExternalLinksTracker;\n\n  moj.Modules.ExternalLinksTracker = {\n    init: function() {\n      $('a[rel=external]').each(function() {\n        $(this).data('ExternalLinksTracker', new ExternalLinksTracker($(this), $(this).data()));\n      });\n    }\n  };\n}());\n","/**\n * Page exit prompt\n *\n * Prompts the user upon leaving the page if they have changed\n * any data in any form.\n */\n\n(function(){\n  'use strict';\n\n  window.moj = window.moj || { Modules: {}, Events: $({}) };\n\n  var PromptOnChange = function(options) {\n    this.init(options);\n    return this;\n  };\n\n  PromptOnChange.prototype = {\n    defaults: {\n      message: \"You have entered some information\"\n    },\n\n    init: function(options) {\n      this.settings = $.extend({}, this.defaults, options);\n      this.enable();\n      this.initMetaRefresh();\n      this.hashedFields = this.hashFields();\n      this.bindEvents();\n    },\n\n    bindEvents: function() {\n      var self = this;\n\n      $('form').on('submit', function() {\n        self.disable();\n      });\n\n      $(window).on('beforeunload', function() {\n        return self.runCheck();\n      });\n    },\n\n    hashFields: function() {\n      return $('form').serialize();\n    },\n\n    fieldsHaveChanged: function() {\n      return this.hashFields() !== this.hashedFields;\n    },\n\n    runCheck: function() {\n      var self = this;\n\n      if (this.isEnabled && this.fieldsHaveChanged() && this.isMetaRefresh() === false) {\n        return self.settings.message;\n      }\n    },\n\n    enable: function() {\n      this.isEnabled = true;\n    },\n\n    disable: function() {\n      this.isEnabled = false;\n    },\n\n    isMetaRefresh: function() {\n      if (typeof this.metaRefreshAt !== 'undefined') {\n        var now = new Date().getTime();\n\n        if (now >= this.metaRefreshAt) {\n          return true;\n        }\n      }\n\n      return false;\n    },\n\n    initMetaRefresh: function() {\n      var refreshTag = $('head').find('meta[http-equiv=refresh]');\n\n      if (refreshTag.length) {\n        var refreshTimeoutLength = parseInt(refreshTag.attr('content').match(/^\\d*/)[0]);\n        var now = new Date().getTime();\n\n        this.metaRefreshAt = now + ((refreshTimeoutLength-1)*1000);\n      }\n    }\n  };\n\n  moj.Modules._PromptOnChange = PromptOnChange;\n\n  moj.Modules.PromptOnChange = {\n    init: function() {\n      var options = {\n        message: $('[name=promptOnChangeMessage]').val() || \"You have entered some information\"\n      };\n      return new PromptOnChange(options);\n    }\n  };\n\n}());\n","/**\n * Selection Buttons\n *\n * Provides extra focused and selected classes to radio and checkbox\n * form inputs to bring them to default gov.uk styling\n */\n\n(function() {\n  'use strict';\n\n  window.moj = window.moj || { Modules: {}, Events: $({}) };\n\n  moj.Modules.SelectionButtons = {\n    init: function() {\n\n      $('label input[type=radio], label input[type=checkbox]').on({\n        'change': function(){\n          if ($(this).is(':checked')) {\n            if ($(this).is(':radio')) {\n              $(this).closest('form').find('[name=\"' + $(this).attr('name') + '\"]').closest('label').removeClass('selected');\n            }\n            $(this).closest('label').addClass('selected');\n          }\n          else {\n            $(this).closest('label').removeClass('selected');\n          }\n        },\n        'focus': function() {\n          $(this).closest('label').addClass('focused');\n        },\n        'blur': function() {\n          $(this).closest('label').removeClass('focused');\n        }\n      }).trigger('change');\n\n    }\n  };\n\n}());\n","/**\n * Templated Element\n *\n * Update the text of an element based on the value of a related input field\n *\n * -----------------------------------------------------------------------\n * Usage:\n *\n * <span class=\"js-TemplatedElement\"\n *     data-template-trigger=\"field_name\"\n *     data-template=\"Content with {value}\"\n *     data-template-defaults-for=\"Excluded value\"\n *     data-template-delegate=\"#other-element\">Original content</span>\n *\n * If templateDelegate is set, the functionality will be transferred to the\n * matching element.\n */\n(function() {\n  'use strict';\n\n  window.moj = window.moj || { Modules: {}, Events: $({}) };\n\n  var TemplatedElement = function($el, options) {\n    this.init($el, options);\n    return this;\n  };\n\n  TemplatedElement.prototype = {\n    defaults: {\n      trigger: '',\n      template: '{value}',\n      defaultsFor: null\n    },\n\n    init: function($el, options) {\n      this.settings = $.extend({}, this.defaults, options);\n\n      this.trigger = $el.data('templateTrigger') || this.settings.trigger;\n      this.template = $el.data('template') || this.settings.template;\n      this.defaultsFor = $el.data('templateDefaultsFor') || this.settings.defaultsFor;\n\n      if ($el.data('templateDelegate')) {\n        $el = $($el.data('templateDelegate'));\n      }\n\n      this.originalText = $el.eq(0).text();\n\n      this.cacheElements($el);\n\n      this.bindEvents();\n    },\n\n    cacheElements: function($el) {\n      this.$element = $el;\n      this.$inputs = $(':radio[name=\"' + this.trigger + '\"]');\n    },\n\n    bindEvents: function() {\n      var self = this;\n      this.$inputs.on('change.TemplatedElement', function() {\n        self.updateText();\n      });\n      moj.Events.on('render.TemplatedElement', function() {\n        self.updateText();\n      });\n    },\n\n    getCurrentValue: function() {\n      var $currentSelection = this.$inputs.filter(':checked');\n      var currentValue = $currentSelection.attr('data-template-value') || $currentSelection.parent('label').text();\n\n      return currentValue.trim();\n    },\n\n    formatValue: function(value) {\n      return value.toLowerCase();\n    },\n\n    updateText: function() {\n      this.$element.text(this.getText());\n    },\n\n    getText: function() {\n      var text = this.originalText,\n          value = this.getCurrentValue();\n\n      if (value && value !== this.defaultsFor) {\n        value = this.formatValue(value);\n        text = this.populateTemplate(value);\n      }\n\n      return text;\n    },\n\n    populateTemplate: function(value) {\n      return this.template.replace('{value}', value);\n    }\n  };\n\n  moj.Modules._TemplatedElement = TemplatedElement;\n\n  moj.Modules.TemplatedElement = {\n    init: function() {\n      return $('[data-template]').each(function() {\n        $(this).data('TemplatedElement', new TemplatedElement($(this), $(this).data()));\n      });\n    }\n  };\n\n}());\n","\n(function(){\n  'use strict';\n\n  window.moj = window.moj || { Modules: {}, Events: $({}) };\n\n  /**\n   * Move focus to main content when using the Skip link\n   */\n  $('.skiplink').on('click', function() {\n    $('#content').attr('tabindex', -1).on('blur focusout', function() {\n      $(this).removeAttr('tabindex');\n    }).focus();\n  });\n\n  /**\n   * Move focus to error summary or success header when present\n   */\n\n\n  /**\n   * Move focus to associated field when clicking an error summary error message\n   */\n\n})();\n","$(function() {\n  jQuery.fx.off = true;\n\n  $('.nojs-only[name=split_form]').remove();\n\n  $(document).on('click', '.skiplink', function() {\n    $('#content').attr('tabindex', -1).on('blur focusout', function() {\n      $(this).removeAttr('tabindex');\n    }).focus();\n  });\n\n  // Handle spacebar use on links with role=button\n  $(document).on('keypress', 'a[role=button]', function(event){\n    if (event.keyCode === 32) {\n      event.preventDefault();\n      event.target.click();\n    }\n  });\n});\n"],"sourceRoot":"/source/"}