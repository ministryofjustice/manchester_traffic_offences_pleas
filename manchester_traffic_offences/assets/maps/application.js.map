{"version":3,"sources":["bind.js","trim.js","moj.CalculateTotals.js","moj.Conditional.js","moj.Details.js","moj.ExternalLinksTracker.js","moj.FocusHandler.js","moj.PromptOnChange.js","moj.SelectionButtons.js","moj.TemplatedElement.js","application.js"],"names":["Function","prototype","bind","oThis","this","TypeError","aArgs","Array","slice","call","arguments","fToBind","fNOP","fBound","apply","concat","String","trim","rtrim","replace","window","moj","Modules","Events","$","CalculateTotals","$el","options","init","defaults","terms","precision","settings","extend","termSelector","data","cacheElements","bindEvents","$total","$terms","self","on","updateTotal","getNumericValue","$element","value","text","is","val","isNumeric","parseFloat","getTotal","total","each","formatNumber","trigger","number","parts","toFixed","toString","split","join","_CalculateTotals","Conditional","addAriaAttributes","$conditional","$inputs","toggle","attr","getInputValue","$input","filter","find","currentValue","testExpression","RegExp","match","show","hide","_Conditional","Details","addClass","prependTo","isOpera","Object","opera","openText","$details","closedText","$summaryText","updateState","$summary","$content","$icon","id","index","role","aria-controls","aria-expanded","aria-hidden","off","click.details","event","preventDefault","toggleContent","keydown.details","keyCode","click","hasClass","removeClass","toggleClass","_Details","ExternalLinksTracker","eventCategory","eventAction","document","location","pathname","ga","$links","sendGAEvent","href","target","hitCallback","openLink","test","open","_ExternalLinksTracker","FocusHandler","$firstAlert","eq","addTabIndex","focus","$target","setTimeout","tabIndex","undefined","PromptOnChange","message","enable","initMetaRefresh","hashedFields","hashFields","disable","runCheck","serialize","fieldsHaveChanged","isEnabled","isMetaRefresh","metaRefreshAt","now","Date","getTime","refreshTag","length","refreshTimeoutLength","parseInt","_PromptOnChange","SelectionButtons","change","closest","blur","TemplatedElement","template","defaultsFor","originalText","updateText","getCurrentValue","$currentSelection","parent","formatValue","toLowerCase","getText","populateTemplate","_TemplatedElement","jQuery","fx","remove"],"mappings":"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","file":"application.js","sourcesContent":["/**\n * Polyfill for browsers not supporting native bind()\n *\n * https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Global_objects/Function/bind\n */\n if (!Function.prototype.bind) {\n   Function.prototype.bind = function(oThis) {\n     if (typeof this !== 'function') {\n       // closest thing possible to the ECMAScript 5\n       // internal IsCallable function\n       throw new TypeError('Function.prototype.bind - what is trying to be bound is not callable');\n     }\n\n     var aArgs   = Array.prototype.slice.call(arguments, 1),\n         fToBind = this,\n         fNOP    = function() {},\n         fBound  = function() {\n           return fToBind.apply(this instanceof fNOP\n                  ? this\n                  : oThis,\n                  aArgs.concat(Array.prototype.slice.call(arguments)));\n         };\n\n     fNOP.prototype = this.prototype;\n     fBound.prototype = new fNOP();\n\n     return fBound;\n   };\n }\n","/**\n * Polyfill for browsers not supporting native trim()\n *\n * https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Global_Objects/String/trim\n */\n if (!String.prototype.trim) {\n   (function() {\n     // Make sure we trim BOM and NBSP\n     var rtrim = /^[\\s\\uFEFF\\xA0]+|[\\s\\uFEFF\\xA0]+$/g;\n     String.prototype.trim = function() {\n       return this.replace(rtrim, '');\n     };\n   })();\n }\n","/**\n * Calculate totals\n *\n * Calculate totals for a selection of terms.\n *\n * -----------------------------------------------------------------------\n * Usage:\n *\n * <span class=\"js-CalculateTotals\" data-total-terms=\".term\" data-total-precision=\"2\"></span>\n */ \n(function() {\n  'use strict';\n\n  window.moj = window.moj || { Modules: {}, Events: $({}) };\n\n  var CalculateTotals = function($el, options) {\n    this.init($el, options);\n    return this;\n  };\n\n  CalculateTotals.prototype = {\n    defaults: {\n      terms: '.term', // Selector for list of terms\n      precision: 2 // Rounding precision (use 0 for integer result)\n    },\n\n    init: function($el, options) {\n      this.settings = $.extend({}, this.defaults, options);\n\n      this.termSelector = $el.data('totalTerms') || this.settings.terms;\n      this.precision = $el.data('totalPrecision') || this.settings.precision;\n\n      this.cacheElements($el);\n\n      this.bindEvents();\n    },\n\n    cacheElements: function($el) {\n      this.$total = $el;\n      this.$terms = $(this.termSelector);\n    },\n\n    bindEvents: function() {\n      var self = this;\n      this.$terms\n        .on('change.CalculateTotals update.CalculateTotals', function() {\n          self.updateTotal();\n        });\n      moj.Events\n        .on('render.CalculateTotals', function() {\n          self.updateTotal();\n        });\n    },\n\n    getNumericValue: function($element) {\n      var value = $element.text();\n      \n      if ($element.is(':input')) {\n        value = $element.val();\n      }\n\n      // Remove commas\n      value = value.replace(/,/g,'');\n\n      return ($.isNumeric(value)) ? parseFloat(value) : 0;\n    },\n\n    getTotal: function() {\n      var self = this,\n          total = 0;\n\n      this.$terms.each(function() {\n        total += self.getNumericValue($(this));\n      });\n\n      return total;\n    },\n\n    updateTotal: function() {\n      var total = this.getTotal();\n\n      total = this.formatNumber(total);\n      this.$total.text(total).trigger('update.CalculateTotals');\n    },\n\n    formatNumber: function(number) {\n      var parts = number.toFixed(this.precision).toString().split(\".\");\n          parts[0] = parts[0].replace(/\\B(?=(\\d{3})+(?!\\d))/g, \",\");\n\n      return parts.join(\".\");\n    }\n  };\n\n  moj.Modules._CalculateTotals = CalculateTotals;\n\n  moj.Modules.CalculateTotals = {\n    init: function() {\n      return $('.js-CalculateTotals').each(function() {\n        $(this).data('CalculateTotals', new CalculateTotals($(this), $(this).data()));\n      });\n    }\n  };\n\n}());","/**\n * Conditional form elements reveal\n *\n * Reveal content based on value of related field\n *\n * -----------------------------------------------------------------------\n * Usage:\n * \n * <input type=\"radio\" name=\"trigger_name\" value=\"regex\">\n * <input type=\"radio\" name=\"trigger_name\" value=\"another value\">\n * <div class=\"js-Conditional\" id=\"target_id\" data-conditional-trigger=\"trigger_name\" data-conditional-value=\"^regex$\">...</div>\n */\n\n(function() {\n  'use strict';\n\n  window.moj = window.moj || { Modules: {}, Events: $({}) };\n\n  var Conditional = function($el, options) {\n    this.init($el, options);\n    return this;\n  };\n\n  Conditional.prototype = {\n    defaults: {},\n\n    init: function($el, options) {\n      this.settings = $.extend({}, this.defaults, options);\n      this.cacheElements($el);\n      this.addAriaAttributes();\n      this.bindEvents();\n    },\n\n    cacheElements: function($el) {\n      this.$conditional = $el;\n      this.$inputs = $('[name=\"' + $el.data('conditionalTrigger') + '\"]');\n    },\n\n    bindEvents: function() {\n      var self = this;\n      this.$inputs\n        .on('change.Conditional', function() {\n          self.toggle();\n        });\n      moj.Events\n        .on('render.Conditional', function() {\n          self.toggle();\n        });\n    },\n\n    addAriaAttributes: function() {\n      this.$inputs.attr('aria-controls', this.$conditional.attr('id'));\n    },\n\n    getInputValue: function($input) {\n      switch($input.attr('type')) {\n        case \"radio\":\n          return $('[name=\"' + $input.attr('name') + '\"]:checked').attr('value');\n\n        case \"checkbox\":\n          return $input.filter(':checked').val();\n\n        default:\n          return $input.val() || $input.find(':selected').attr('value');\n      }\n    },\n\n    toggle: function() {\n      var currentValue = this.getInputValue(this.$inputs),\n          testExpression = new RegExp(this.$conditional.data('conditionalValue'));\n\n      if (currentValue && currentValue.match(testExpression)) {\n        this.$conditional\n          .show()\n          .attr('aria-expanded', 'true')\n          .attr('aria-hidden', 'false');\n      }\n      else {\n        this.$conditional\n          .hide()\n          .attr('aria-expanded', 'false')\n          .attr('aria-hidden', 'true');\n      }\n    }\n  };\n\n  moj.Modules._Conditional = Conditional;\n\n  moj.Modules.Conditional = {\n    init: function() {\n      return $('.js-Conditional').each(function() {\n        $(this).data('Conditional', new Conditional($(this), $(this).data()));\n      });\n    }\n  };\n\n}());","/**\n * Details Element\n *\n * Replicate <details> functionality that's entirely cross-browser\n * compatible and offers options to update text depending on state\n *\n * -----------------------------------------------------------------------\n * Usage:\n *\n * <div class=\"js-Details [open]\" data-summary-open=\"Alternative text\">\n *   <a class=\"details-trigger\" href=\"#details-content\"><span class=\"summary\">View details</span></a>\n *   <div class=\"details-content\" id=\"details-content\">\n *     Content here\n *   </div>\n * </div>\n *\n * If summaryOpen is set, the summary text is replaced when open. Copy in markup\n * should always be for the closed state.\n */\n(function() {\n  \"use strict\";\n\n  window.moj = window.moj || { Modules: {}, Events: $({}) };\n\n  var Details = function($el, options) {\n    this.init($el, options);\n    return this;\n  };\n\n  Details.prototype = {\n\n    init: function($el, options) {\n      \n      $(\"<i>\").addClass(\"arrow arrow-closed\").text(\"\\u25ba\").prependTo($('.details-trigger', $el));\n\n      this.cacheElements($el);\n      this.addAriaAttributes();\n      this.bindEvents();\n\n      this.isOpera = Object.prototype.toString.call(window.opera) == \"[object Opera]\";\n\n      this.openText = this.$details.data(\"summary-open\");\n      this.closedText = this.$summaryText.text();\n\n      this.updateState();\n    },\n\n    cacheElements: function($el) {\n      this.$details = $el;\n      this.$summary = $(\".details-trigger\", $el);\n      this.$summaryText = $(\".summary\", this.$summary);\n      this.$content = $(\".details-content\", $el);\n      this.$icon = $(\"i.arrow\", this.$summary);\n    },\n\n    addAriaAttributes: function() {\n      var id = this.$content.attr(\"id\");\n\n      if (!id) {\n        id = \"js-details-\" + this.$details.index(\".js-Details\");\n        this.$content.attr(\"id\", id);\n      }\n\n      this.$summary.attr({\n        \"role\": \"button\",\n        \"aria-controls\": id,\n        \"aria-expanded\": \"false\"\n      });\n\n      this.$content.attr({\n        \"aria-hidden\": \"true\"\n      });\n    },\n\n    bindEvents: function() {\n      var self = this;\n\n      this.$summary.off(\"click.details keydown.details\").on({\n        \"click.details\": function(event) {\n          event.preventDefault();\n          self.toggleContent();\n        },\n        \"keydown.details\": function(event) {\n          if (event.keyCode == 32 || (event.keyCode == 13 && !self.isOpera)) {\n            event.preventDefault();\n            self.$summary.click();\n          }\n        }\n      });\n    },\n\n    updateState: function() {\n      if (this.$details.hasClass(\"open\")) {\n        this.$summary.attr(\"aria-expanded\", \"true\");\n        this.$content.show().attr(\"aria-hidden\", \"false\");\n        this.$icon.removeClass(\"arrow-closed\").addClass(\"arrow-open\").text(\"\\u25bc\");\n\n        if (this.openText) {\n          this.$summaryText.text(this.openText);\n        }\n      }\n      else {\n        this.$summary.attr(\"aria-expanded\", \"false\");\n        this.$content.hide().attr(\"aria-hidden\", \"true\");\n        this.$icon.removeClass(\"arrow-open\").addClass(\"arrow-closed\").text(\"\\u25ba\");\n\n        if (this.openText) {\n          this.$summaryText.text(this.closedText);\n        }\n      }\n    },\n\n    toggleContent: function() {\n      this.$details.toggleClass(\"open\");\n      this.updateState();\n    }\n  };\n\n  moj.Modules._Details = Details;\n\n  moj.Modules.Details = {\n    init: function() {\n      return $(\".js-Details\").each(function() {\n        $(this).data(\"Details\", new Details($(this), $(this).data()));\n      });\n    }\n  };\n\n}());","(function() {\n  \"use strict\";\n\n  window.moj = window.moj || { Modules: {}, Events: $({}) };\n\n  var ExternalLinksTracker = function($el, options) {\n    this.init($el, options);\n    return this;\n  };\n\n  ExternalLinksTracker.prototype = {\n    defaults: {\n      \"eventCategory\": \"External links\",\n      \"eventAction\": document.location.pathname\n    },\n\n    init: function($el, options) {\n      if (typeof ga === \"undefined\") return;\n\n      this.settings = $.extend({}, this.defaults, options);\n      this.cacheElements($el);\n      this.bindEvents();\n    },\n\n    cacheElements: function($el) {\n      this.$links = $el;\n    },\n\n    bindEvents: function() {\n      var self = this;\n\n      this.$links.on('click', function(event) {\n        event.preventDefault();\n        self.sendGAEvent($(this));\n      });\n    },\n\n    sendGAEvent: function($el) {\n      var self = this,\n          href = $el.attr(\"href\"),\n          target = $el.attr(\"target\");\n\n      ga(\"send\",\n         \"event\",\n         self.settings.eventCategory,\n         href,\n         self.settings.eventAction,\n         {\"hitCallback\": self.openLink(href, target)}\n      );\n    },\n\n    openLink: function(href, target) {\n      if (target && !/^_(self|parent|top)$/i.test(target)) {\n        window.open(href, target);\n      }\n      else {\n        window.location.href = href;\n      }\n    }\n  };\n\n  moj.Modules._ExternalLinksTracker = ExternalLinksTracker;\n\n  moj.Modules.ExternalLinksTracker = {\n    init: function() {\n      $('a[rel=external]').each(function() {\n        $(this).data('ExternalLinksTracker', new ExternalLinksTracker($(this), $(this).data()));\n      });\n    }\n  };\n}());","/**\n * Handle several aspects of focusing on the relevant element\n */\n(function() {\n  'use strict';\n\n  window.moj = window.moj || { Modules: {}, Events: $({}) };\n\n  moj.Modules.FocusHandler = {\n    init: function() {\n      var $firstAlert = $('.success-header, .error-summary').eq(0);\n\n      /**\n       * Set focus to the first alert or success on the page\n       */\n      this.addTabIndex($firstAlert, '0');\n      $firstAlert.focus();\n\n      /**\n       * Set focus to the main content when clicking the 'skip link'\n       */\n      this.addTabIndex($('#content'), '-1');\n      $('.skiplink').on('click', function() { $('#content').focus(); });\n\n      /**\n       * Set focus to the relevant field when clicking an error message in the summary\n       */\n      $('.error-summary [href^=#section_]').on('click', function() {\n        var $target = $($(this).attr('href')).find('input, textarea, select').eq(0);\n        setTimeout(function() { $target.focus(); }, 250);\n      });\n    },\n    addTabIndex: function($el, tabIndex) {\n      if ($el.attr('tabindex') === undefined) {\n        $el.attr('tabindex', tabIndex);\n      }\n    }\n  };\n}());\n","/**\n * Page exit prompt\n *\n * Prompts the user upon leaving the page if they have changed\n * any data in any form.\n */\n\n(function(){\n  'use strict';\n\n  window.moj = window.moj || { Modules: {}, Events: $({}) };\n\n  var PromptOnChange = function(options) {\n    this.init(options);\n    return this;\n  };\n\n  PromptOnChange.prototype = {\n    defaults: {\n      message: \"You have entered some information\"\n    },\n\n    init: function(options) {\n      this.settings = $.extend({}, this.defaults, options);\n      this.enable();\n      this.initMetaRefresh();\n      this.hashedFields = this.hashFields();\n      this.bindEvents();\n    },\n\n    bindEvents: function() {\n      var self = this;\n\n      $('form').on('submit', function() {\n        self.disable();\n      });\n\n      $(window).on('beforeunload', function() {\n        return self.runCheck();\n      });\n    },\n\n    hashFields: function() {\n      return $('form').serialize();\n    },\n\n    fieldsHaveChanged: function() {\n      return this.hashFields() !== this.hashedFields;\n    },\n\n    runCheck: function() {\n      var self = this;\n\n      if (this.isEnabled && this.fieldsHaveChanged() && this.isMetaRefresh() === false) {\n        return self.settings.message;\n      }\n    },\n\n    enable: function() {\n      this.isEnabled = true;\n    },\n\n    disable: function() {\n      this.isEnabled = false;\n    },\n\n    isMetaRefresh: function() {      \n      if (typeof this.metaRefreshAt !== 'undefined') {\n        var now = new Date().getTime();\n        \n        if (now >= this.metaRefreshAt) {\n          return true;\n        }\n      }\n\n      return false;\n    },\n\n    initMetaRefresh: function() {\n      var refreshTag = $('head').find('meta[http-equiv=refresh]');\n      \n      if (refreshTag.length) {\n        var refreshTimeoutLength = parseInt(refreshTag.attr('content').match(/^\\d*/)[0]);\n        var now = new Date().getTime();\n        \n        this.metaRefreshAt = now + ((refreshTimeoutLength-1)*1000);\n      }\n    }\n  };\n\n  moj.Modules._PromptOnChange = PromptOnChange;\n  \n  moj.Modules.PromptOnChange = {\n    init: function() {\n      var options = {\n        message: $('[name=promptOnChangeMessage]').val() || \"You have entered some information\"\n      };\n      return new PromptOnChange(options);\n    }\n  };\n\n}());","/**\n * Selection Buttons\n *\n * Provides extra focused and selected classes to radio and checkbox\n * form inputs to bring them to default gov.uk styling\n */\n\n(function() {\n  'use strict';\n\n  window.moj = window.moj || { Modules: {}, Events: $({}) };\n\n  moj.Modules.SelectionButtons = {\n    init: function() {\n\n      $('label input[type=radio], label input[type=checkbox]').on({\n        'change': function(){\n          if ($(this).is(':checked')) {\n            if ($(this).is(':radio')) {\n              $(this).closest('form').find('[name=\"' + $(this).attr('name') + '\"]').closest('label').removeClass('selected');\n            }\n            $(this).closest('label').addClass('selected');\n          }\n          else {\n            $(this).closest('label').removeClass('selected');\n          }\n        },\n        'focus': function() {\n          $(this).closest('label').addClass('focused');\n        },\n        'blur': function() {\n          $(this).closest('label').removeClass('focused');\n        }\n      }).trigger('change');\n\n    }\n  };\n\n}());\n","/**\n * Templated Element\n *\n * Update the text of an element based on the value of a related input field\n *\n * -----------------------------------------------------------------------\n * Usage:\n *\n * <span class=\"js-TemplatedElement\" \n *     data-template-trigger=\"field_name\"\n *     data-template=\"Content with {value}\" \n *     data-template-defaults-for=\"Excluded value\"\n *     data-template-delegate=\"#other-element\">Original content</span>\n *\n * If templateDelegate is set, the functionality will be transferred to the\n * matching element.\n */\n(function() {\n  'use strict';\n\n  window.moj = window.moj || { Modules: {}, Events: $({}) };\n\n  var TemplatedElement = function($el, options) {\n    this.init($el, options);\n    return this;\n  };\n\n  TemplatedElement.prototype = {\n    defaults: {\n      trigger: '',\n      template: '{value}',\n      defaultsFor: null\n    },\n\n    init: function($el, options) {\n      this.settings = $.extend({}, this.defaults, options);\n\n      this.trigger = $el.data('templateTrigger') || this.settings.trigger;\n      this.template = $el.data('template') || this.settings.template;\n      this.defaultsFor = $el.data('templateDefaultsFor') || this.settings.defaultsFor;\n      \n      \n      if ($el.data('templateDelegate')) {\n        $el = $($el.data('templateDelegate'));\n      }\n\n      this.originalText = $el.eq(0).text();\n\n      this.cacheElements($el);\n\n      this.bindEvents();\n    },\n\n    cacheElements: function($el) {\n      this.$element = $el;\n      this.$inputs = $(':radio[name=\"' + this.trigger + '\"]');\n    },\n\n    bindEvents: function() {\n      var self = this;\n      this.$inputs.on('change.TemplatedElement', function() {\n        self.updateText();\n      });\n      moj.Events.on('render.TemplatedElement', function() {\n        self.updateText();\n      });\n    },\n\n    getCurrentValue: function() {\n      var $currentSelection = this.$inputs.filter(':checked');\n      var currentValue = $currentSelection.attr('data-template-value') || $currentSelection.parent('label').text();\n\n      return currentValue.trim();\n    },\n\n    formatValue: function(value) {\n      return value.toLowerCase();\n    },\n\n    updateText: function() {\n      this.$element.text(this.getText());\n    },\n\n    getText: function() {\n      var text = this.originalText,\n          value = this.getCurrentValue();\n\n      if (value && value !== this.defaultsFor) {\n        value = this.formatValue(value);\n        text = this.populateTemplate(value);\n      }\n\n      return text;\n    },\n\n    populateTemplate: function(value) {\n      return this.template.replace('{value}', value);\n    }\n  };\n\n  moj.Modules._TemplatedElement = TemplatedElement;\n\n  moj.Modules.TemplatedElement = {\n    init: function() {\n      return $('.js-TemplatedElement').each(function() {\n        $(this).data('TemplatedElement', new TemplatedElement($(this), $(this).data()));\n      });\n    }\n  };\n\n}());","$(function() {\n  jQuery.fx.off = true;\n  $('.nojs-only[name=split_form]').remove();\n});\n"],"sourceRoot":"/source/"}