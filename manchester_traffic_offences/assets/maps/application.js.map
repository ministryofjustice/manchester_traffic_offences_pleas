{"version":3,"sources":["bind.js","trim.js","moj.Conditional.js","moj.Details.js","moj.ExternalLinksTracker.js","moj.PromptOnChange.js","moj.SelectionButtons.js","moj.TemplatedElement.js","moj.focusEvents.js","application.js"],"names":["Function","prototype","bind","oThis","this","TypeError","aArgs","Array","slice","call","arguments","fToBind","fNOP","fBound","apply","concat","String","trim","rtrim","replace","window","moj","Modules","Events","$","Conditional","$el","options","init","defaults","settings","extend","cacheElements","addAriaAttributes","bindEvents","$conditional","$inputs","data","self","on","toggle","conditionalId","attr","not","each","i","currentAttribute","getInputValue","$input","filter","val","find","currentValue","testExpression","RegExp","match","show","removeAttr","removeProp","hide","prop","_Conditional","Details","addClass","text","prependTo","isOpera","Object","toString","opera","openText","$details","closedText","$summaryText","updateState","$summary","$content","$icon","id","index","role","aria-controls","aria-expanded","aria-hidden","off","click.details","event","preventDefault","toggleContent","keydown.details","keyCode","click","hasClass","removeClass","toggleClass","_Details","ExternalLinksTracker","eventCategory","eventAction","document","location","pathname","ga","$links","sendGAEvent","href","target","hitCallback","openLink","test","open","_ExternalLinksTracker","PromptOnChange","message","enable","initMetaRefresh","hashedFields","hashFields","disable","runCheck","serialize","fieldsHaveChanged","isEnabled","isMetaRefresh","metaRefreshAt","now","Date","getTime","refreshTag","length","refreshTimeoutLength","parseInt","_PromptOnChange","SelectionButtons","change","is","closest","focus","blur","trigger","TemplatedElement","template","defaultsFor","originalText","eq","$element","updateText","getCurrentValue","$currentSelection","parent","formatValue","value","toLowerCase","getText","populateTemplate","_TemplatedElement","jQuery","fx","remove"],"mappings":"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","file":"application.js","sourcesContent":["/**\n * Polyfill for browsers not supporting native bind()\n *\n * https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Global_objects/Function/bind\n */\n if (!Function.prototype.bind) {\n   Function.prototype.bind = function(oThis) {\n     if (typeof this !== 'function') {\n       // closest thing possible to the ECMAScript 5\n       // internal IsCallable function\n       throw new TypeError('Function.prototype.bind - what is trying to be bound is not callable');\n     }\n\n     var aArgs   = Array.prototype.slice.call(arguments, 1),\n         fToBind = this,\n         fNOP    = function() {},\n         fBound  = function() {\n           return fToBind.apply(this instanceof fNOP\n                  ? this\n                  : oThis,\n                  aArgs.concat(Array.prototype.slice.call(arguments)));\n         };\n\n     fNOP.prototype = this.prototype;\n     fBound.prototype = new fNOP();\n\n     return fBound;\n   };\n }\n","/**\n * Polyfill for browsers not supporting native trim()\n *\n * https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Global_Objects/String/trim\n */\n if (!String.prototype.trim) {\n   (function() {\n     // Make sure we trim BOM and NBSP\n     var rtrim = /^[\\s\\uFEFF\\xA0]+|[\\s\\uFEFF\\xA0]+$/g;\n     String.prototype.trim = function() {\n       return this.replace(rtrim, '');\n     };\n   })();\n }\n","/**\n * Conditional form elements reveal\n *\n * Reveal content based on value of related field\n *\n * -----------------------------------------------------------------------\n * Usage:\n *\n * <input type=\"radio\" name=\"trigger_name\" value=\"regex\">\n * <input type=\"radio\" name=\"trigger_name\" value=\"another value\">\n * <div id=\"target_id\" data-conditional=\"trigger_name\" data-conditional-value=\"^regex$\">...</div>\n */\n\n(function() {\n  'use strict';\n\n  window.moj = window.moj || { Modules: {}, Events: $({}) };\n\n  var Conditional = function($el, options) {\n    this.init($el, options);\n    return this;\n  };\n\n  Conditional.prototype = {\n    defaults: {},\n\n    init: function($el, options) {\n      this.settings = $.extend({}, this.defaults, options);\n      this.cacheElements($el);\n      this.addAriaAttributes();\n      this.bindEvents();\n    },\n\n    cacheElements: function($el) {\n      this.$conditional = $el;\n      this.$inputs = $('[name=\"' + $el.data('conditional') + '\"]');\n    },\n\n    bindEvents: function() {\n      var self = this;\n      this.$inputs\n        .on('change.Conditional', function() {\n          self.toggle();\n        });\n      moj.Events\n        .on('render.Conditional', function() {\n          self.toggle();\n        });\n    },\n\n    addAriaAttributes: function() {\n      var conditionalId = this.$conditional.attr('id');\n      this.$inputs.not('[aria-controls*=' + conditionalId + ']').each(function() {\n        $(this).attr('aria-controls', function(i, currentAttribute) {\n          return currentAttribute ? currentAttribute + ' ' + conditionalId : conditionalId;\n        });\n      });\n      this.$conditional.attr('aria-live', 'polite');\n    },\n\n    getInputValue: function($input) {\n      switch($input.attr('type')) {\n        case \"radio\":\n          return $('[name=\"' + $input.attr('name') + '\"]:checked').attr('value');\n\n        case \"checkbox\":\n          return $input.filter(':checked').val();\n\n        default:\n          return $input.val() || $input.find(':selected').attr('value');\n      }\n    },\n\n    toggle: function() {\n      var currentValue = this.getInputValue(this.$inputs),\n          testExpression = new RegExp(this.$conditional.data('conditionalValue'));\n\n      if (currentValue && currentValue.match(testExpression)) {\n        this.$conditional\n          .show()\n          .attr('aria-expanded', 'true')\n          .removeAttr('aria-hidden')\n          .removeProp('hidden');\n      }\n      else {\n        this.$conditional\n          .hide()\n          .attr('aria-expanded', 'false')\n          .attr('aria-hidden', 'true')\n          .prop('hidden', true);\n      }\n    }\n  };\n\n  moj.Modules._Conditional = Conditional;\n\n  moj.Modules.Conditional = {\n    init: function() {\n      return $('[data-conditional]').each(function() {\n        $(this).data('Conditional', new Conditional($(this), $(this).data()));\n      });\n    }\n  };\n\n}());\n","/**\n * Details Element\n *\n * Replicate <details> functionality that's entirely cross-browser\n * compatible and offers options to update text depending on state\n *\n * -----------------------------------------------------------------------\n * Usage:\n *\n * <div class=\"js-Details [open]\" data-summary-open=\"Alternative text\">\n *   <a class=\"details-trigger\" href=\"#details-content\"><span class=\"summary\">View details</span></a>\n *   <div class=\"details-content\" id=\"details-content\">\n *     Content here\n *   </div>\n * </div>\n *\n * If summaryOpen is set, the summary text is replaced when open. Copy in markup\n * should always be for the closed state.\n */\n(function() {\n  \"use strict\";\n\n  window.moj = window.moj || { Modules: {}, Events: $({}) };\n\n  var Details = function($el, options) {\n    this.init($el, options);\n    return this;\n  };\n\n  Details.prototype = {\n\n    init: function($el, options) {\n\n      $(\"<i>\").addClass(\"arrow arrow-closed\").text(\"\\u25ba\").prependTo($('.details-trigger', $el));\n\n      this.cacheElements($el);\n      this.addAriaAttributes();\n      this.bindEvents();\n\n      this.isOpera = Object.prototype.toString.call(window.opera) == \"[object Opera]\";\n\n      this.openText = this.$details.data(\"summary-open\");\n      this.closedText = this.$summaryText.text();\n\n      this.updateState();\n    },\n\n    cacheElements: function($el) {\n      this.$details = $el;\n      this.$summary = $(\".details-trigger\", $el);\n      this.$summaryText = $(\".summary\", this.$summary);\n      this.$content = $(\".details-content\", $el);\n      this.$icon = $(\"i.arrow\", this.$summary);\n    },\n\n    addAriaAttributes: function() {\n      var id = this.$content.attr(\"id\");\n\n      if (!id) {\n        id = \"js-details-\" + this.$details.index(\".js-Details\");\n        this.$content.attr(\"id\", id);\n      }\n\n      this.$summary.attr({\n        \"role\": \"button\",\n        \"aria-controls\": id,\n        \"aria-expanded\": \"false\"\n      });\n\n      this.$content.attr({\n        \"aria-hidden\": \"true\"\n      });\n    },\n\n    bindEvents: function() {\n      var self = this;\n\n      this.$summary.off(\"click.details keydown.details\").on({\n        \"click.details\": function(event) {\n          event.preventDefault();\n          self.toggleContent();\n        },\n        \"keydown.details\": function(event) {\n          if (event.keyCode == 32 || (event.keyCode == 13 && !self.isOpera)) {\n            event.preventDefault();\n            self.$summary.click();\n          }\n        }\n      });\n    },\n\n    updateState: function() {\n      if (this.$details.hasClass(\"open\")) {\n        this.$summary.attr(\"aria-expanded\", \"true\");\n        this.$content.show().attr(\"aria-hidden\", \"false\");\n        this.$icon.removeClass(\"arrow-closed\").addClass(\"arrow-open\").text(\"\\u25bc\");\n\n        if (this.openText) {\n          this.$summaryText.text(this.openText);\n        }\n      }\n      else {\n        this.$summary.attr(\"aria-expanded\", \"false\");\n        this.$content.hide().attr(\"aria-hidden\", \"true\");\n        this.$icon.removeClass(\"arrow-open\").addClass(\"arrow-closed\").text(\"\\u25ba\");\n\n        if (this.openText) {\n          this.$summaryText.text(this.closedText);\n        }\n      }\n    },\n\n    toggleContent: function() {\n      this.$details.toggleClass(\"open\");\n      this.updateState();\n    }\n  };\n\n  moj.Modules._Details = Details;\n\n  moj.Modules.Details = {\n    init: function() {\n      return $(\".js-Details\").each(function() {\n        $(this).data(\"Details\", new Details($(this), $(this).data()));\n      });\n    }\n  };\n\n}());\n","(function() {\n  \"use strict\";\n\n  window.moj = window.moj || { Modules: {}, Events: $({}) };\n\n  var ExternalLinksTracker = function($el, options) {\n    this.init($el, options);\n    return this;\n  };\n\n  ExternalLinksTracker.prototype = {\n    defaults: {\n      \"eventCategory\": \"External links\",\n      \"eventAction\": document.location.pathname\n    },\n\n    init: function($el, options) {\n      if (typeof ga === \"undefined\") return;\n\n      this.settings = $.extend({}, this.defaults, options);\n      this.cacheElements($el);\n      this.bindEvents();\n    },\n\n    cacheElements: function($el) {\n      this.$links = $el;\n    },\n\n    bindEvents: function() {\n      var self = this;\n\n      this.$links.on('click', function(event) {\n        event.preventDefault();\n        self.sendGAEvent($(this));\n      });\n    },\n\n    sendGAEvent: function($el) {\n      var self = this,\n          href = $el.attr(\"href\"),\n          target = $el.attr(\"target\");\n\n      ga(\"send\",\n         \"event\",\n         self.settings.eventCategory,\n         href,\n         self.settings.eventAction,\n         {\"hitCallback\": self.openLink(href, target)}\n      );\n    },\n\n    openLink: function(href, target) {\n      if (target && !/^_(self|parent|top)$/i.test(target)) {\n        window.open(href, target);\n      }\n      else {\n        window.location.href = href;\n      }\n    }\n  };\n\n  moj.Modules._ExternalLinksTracker = ExternalLinksTracker;\n\n  moj.Modules.ExternalLinksTracker = {\n    init: function() {\n      $('a[rel=external]').each(function() {\n        $(this).data('ExternalLinksTracker', new ExternalLinksTracker($(this), $(this).data()));\n      });\n    }\n  };\n}());\n","/**\n * Page exit prompt\n *\n * Prompts the user upon leaving the page if they have changed\n * any data in any form.\n */\n\n(function(){\n  'use strict';\n\n  window.moj = window.moj || { Modules: {}, Events: $({}) };\n\n  var PromptOnChange = function(options) {\n    this.init(options);\n    return this;\n  };\n\n  PromptOnChange.prototype = {\n    defaults: {\n      message: \"You have entered some information\"\n    },\n\n    init: function(options) {\n      this.settings = $.extend({}, this.defaults, options);\n      this.enable();\n      this.initMetaRefresh();\n      this.hashedFields = this.hashFields();\n      this.bindEvents();\n    },\n\n    bindEvents: function() {\n      var self = this;\n\n      $('form').on('submit', function() {\n        self.disable();\n      });\n\n      $(window).on('beforeunload', function() {\n        return self.runCheck();\n      });\n    },\n\n    hashFields: function() {\n      return $('form').serialize();\n    },\n\n    fieldsHaveChanged: function() {\n      return this.hashFields() !== this.hashedFields;\n    },\n\n    runCheck: function() {\n      var self = this;\n\n      if (this.isEnabled && this.fieldsHaveChanged() && this.isMetaRefresh() === false) {\n        return self.settings.message;\n      }\n    },\n\n    enable: function() {\n      this.isEnabled = true;\n    },\n\n    disable: function() {\n      this.isEnabled = false;\n    },\n\n    isMetaRefresh: function() {\n      if (typeof this.metaRefreshAt !== 'undefined') {\n        var now = new Date().getTime();\n\n        if (now >= this.metaRefreshAt) {\n          return true;\n        }\n      }\n\n      return false;\n    },\n\n    initMetaRefresh: function() {\n      var refreshTag = $('head').find('meta[http-equiv=refresh]');\n\n      if (refreshTag.length) {\n        var refreshTimeoutLength = parseInt(refreshTag.attr('content').match(/^\\d*/)[0]);\n        var now = new Date().getTime();\n\n        this.metaRefreshAt = now + ((refreshTimeoutLength-1)*1000);\n      }\n    }\n  };\n\n  moj.Modules._PromptOnChange = PromptOnChange;\n\n  moj.Modules.PromptOnChange = {\n    init: function() {\n      var options = {\n        message: $('[name=promptOnChangeMessage]').val() || \"You have entered some information\"\n      };\n      return new PromptOnChange(options);\n    }\n  };\n\n}());\n","/**\n * Selection Buttons\n *\n * Provides extra focused and selected classes to radio and checkbox\n * form inputs to bring them to default gov.uk styling\n */\n\n(function() {\n  'use strict';\n\n  window.moj = window.moj || { Modules: {}, Events: $({}) };\n\n  moj.Modules.SelectionButtons = {\n    init: function() {\n\n      $('label input[type=radio], label input[type=checkbox]').on({\n        'change': function(){\n          if ($(this).is(':checked')) {\n            if ($(this).is(':radio')) {\n              $(this).closest('form').find('[name=\"' + $(this).attr('name') + '\"]').closest('label').removeClass('selected');\n            }\n            $(this).closest('label').addClass('selected');\n          }\n          else {\n            $(this).closest('label').removeClass('selected');\n          }\n        },\n        'focus': function() {\n          $(this).closest('label').addClass('focused');\n        },\n        'blur': function() {\n          $(this).closest('label').removeClass('focused');\n        }\n      }).trigger('change');\n\n    }\n  };\n\n}());\n","/**\n * Templated Element\n *\n * Update the text of an element based on the value of a related input field\n *\n * -----------------------------------------------------------------------\n * Usage:\n *\n * <span class=\"js-TemplatedElement\"\n *     data-template-trigger=\"field_name\"\n *     data-template=\"Content with {value}\"\n *     data-template-defaults-for=\"Excluded value\"\n *     data-template-delegate=\"#other-element\">Original content</span>\n *\n * If templateDelegate is set, the functionality will be transferred to the\n * matching element.\n */\n(function() {\n  'use strict';\n\n  window.moj = window.moj || { Modules: {}, Events: $({}) };\n\n  var TemplatedElement = function($el, options) {\n    this.init($el, options);\n    return this;\n  };\n\n  TemplatedElement.prototype = {\n    defaults: {\n      trigger: '',\n      template: '{value}',\n      defaultsFor: null\n    },\n\n    init: function($el, options) {\n      this.settings = $.extend({}, this.defaults, options);\n\n      this.trigger = $el.data('templateTrigger') || this.settings.trigger;\n      this.template = $el.data('template') || this.settings.template;\n      this.defaultsFor = $el.data('templateDefaultsFor') || this.settings.defaultsFor;\n\n      if ($el.data('templateDelegate')) {\n        $el = $($el.data('templateDelegate'));\n      }\n\n      this.originalText = $el.eq(0).text();\n\n      this.cacheElements($el);\n\n      this.bindEvents();\n    },\n\n    cacheElements: function($el) {\n      this.$element = $el;\n      this.$inputs = $(':radio[name=\"' + this.trigger + '\"]');\n    },\n\n    bindEvents: function() {\n      var self = this;\n      this.$inputs.on('change.TemplatedElement', function() {\n        self.updateText();\n      });\n      moj.Events.on('render.TemplatedElement', function() {\n        self.updateText();\n      });\n    },\n\n    getCurrentValue: function() {\n      var $currentSelection = this.$inputs.filter(':checked');\n      var currentValue = $currentSelection.attr('data-template-value') || $currentSelection.parent('label').text();\n\n      return currentValue.trim();\n    },\n\n    formatValue: function(value) {\n      return value.toLowerCase();\n    },\n\n    updateText: function() {\n      this.$element.text(this.getText());\n    },\n\n    getText: function() {\n      var text = this.originalText,\n          value = this.getCurrentValue();\n\n      if (value && value !== this.defaultsFor) {\n        value = this.formatValue(value);\n        text = this.populateTemplate(value);\n      }\n\n      return text;\n    },\n\n    populateTemplate: function(value) {\n      return this.template.replace('{value}', value);\n    }\n  };\n\n  moj.Modules._TemplatedElement = TemplatedElement;\n\n  moj.Modules.TemplatedElement = {\n    init: function() {\n      return $('.js-TemplatedElement').each(function() {\n        $(this).data('TemplatedElement', new TemplatedElement($(this), $(this).data()));\n      });\n    }\n  };\n\n}());\n","\n(function(){\n  'use strict';\n\n  window.moj = window.moj || { Modules: {}, Events: $({}) };\n\n  /**\n   * Move focus to main content when using the Skip link\n   */\n  $('.skiplink').on('click', function() {\n    $('#content').attr('tabindex', -1).on('blur focusout', function() {\n      $(this).removeAttr('tabindex');\n    }).focus();\n  });\n\n  /**\n   * Move focus to error summary or success header when present\n   */\n\n\n  /**\n   * Move focus to associated field when clicking an error summary error message\n   */\n\n})();\n","$(function() {\n  jQuery.fx.off = true;\n\n  $('.nojs-only[name=split_form]').remove();\n\n  $(document).on('click', '.skiplink', function() {\n    $('#content').attr('tabindex', -1).on('blur focusout', function() {\n      $(this).removeAttr('tabindex');\n    }).focus();\n  });\n\n  // Handle spacebar use on links with role=button\n  $(document).on('keypress', 'a[role=button]', function(event){\n    if (event.keyCode === 32) {\n      event.preventDefault();\n      event.target.click();\n    }\n  });\n});\n"],"sourceRoot":"/source/"}