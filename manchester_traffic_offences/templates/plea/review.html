{% extends "plea/base.html" %}

{% load i18n %}

{% spaceless %}
{% block page_title %}
        {% if case.plea_made_by == "Company representative" %}
            {% blocktrans count charges=case.number_of_charges %}Confirm your company's plea{% plural %}Confirm your company's pleas{% endblocktrans %} - {{ block.super }}
        {% else %}
            {% blocktrans count charges=case.number_of_charges %}Confirm your plea{% plural %}Confirm your pleas{% endblocktrans %} - {{ block.super }}
        {% endif %}
{% endblock %}
{% endspaceless %}

{% block page_content %}
<form action="{{ request.path }}" method="post" autocomplete="off" novalidate>
    
    {% csrf_token %}
    
    {% with forms.0 as form %}
        
    {% if form.errors %}
    <section class="error-summary">
        <h2>{% trans "You need to fix the errors on this page before continuing." %}</h2>
        
        <p>{% trans "See highlighted errors below." %}</p>
        
        <ul>
        {% for field in form %}
            {% if field.errors %}
            <li><a href="#section_{{ field.name }}">{{ field.errors|striptags }}</a></li>
            {% endif %}
        {% endfor %}
        </ul>
    </section>
    {% endif %}

    <header class="content-header">
        {% if case.plea_made_by == "Company representative" %}
            <h1>{% blocktrans count charges=case.number_of_charges %}Confirm your company's plea{% plural %}Confirm your company's pleas{% endblocktrans %}</h1>
        {% else %}
            <h1>{% blocktrans count charges=case.number_of_charges %}Confirm your plea{% plural %}Confirm your pleas{% endblocktrans %}</h1>
        {% endif %}

        <p>{% blocktrans count charges=case.number_of_charges %}Review the information you’ve given before making your plea.{% plural %}Review the information you’ve given before making your pleas.{% endblocktrans %}</p>
    </header>

    {% include "plea/review/case.html" %}

    {% include "plea/review/details.html" %}

    {% include "plea/review/plea.html" %}

    {% if case.plea_made_by == "Defendant" %}
        {% if not your_finances.skipped %}

            {% include "plea/review/finances.html" %}

            {% if your_finances.hardship %}
                {% include "plea/review/expenses.html" %}
            {% endif %}

        {% endif %}
    {% elif case.plea_made_by == "Company representative" %}
        {% if not company_finances.skipped %}
            {% include "plea/review/company_finances.html" %}
        {% endif %}
    {% endif %}

    {% include "plea/review/important.html" %}

    <div class="form-submit">
        <button type="submit" class="button-large">{% blocktrans count charges=case.number_of_charges %}Make your plea{% plural %}Make your pleas{% endblocktrans %}</button>
    </div>
    {% endwith %}

</form>
{% endblock page_content %}
