{% extends "moj_template/base.html" %}

{% load i18n %}
{% load staticfiles %}
{% load waffle_tags %}

{% block cookie_message %}
    <p>{% blocktrans %}GOV.UK uses cookies to make the site simpler.{% endblocktrans %} <a href="{% url "terms" %}#cookies">{% blocktrans %}Find out more about cookies{% endblocktrans %}</a></p>
{% endblock %}

{% block licence_message %}
    <p>{% blocktrans %}All content is available under the <a href="https://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/" rel="license">Open Government Licence v3.0</a>, except where otherwise stated{% endblocktrans %}</p>
{% endblock %}

{% block stylesheets %}
    <link rel="stylesheet" type="text/css" href="{% static "stylesheets/application.css" %}">
    <!--[if IE 6]><link href="{% static "stylesheets/application-ie6.css" %}" media="screen" rel="stylesheet" type="text/css" /><![endif]-->
    <!--[if IE 7]><link href="{% static "stylesheets/application-ie7.css" %}" media="screen" rel="stylesheet" type="text/css" /><![endif]-->
    <!--[if IE 8]><link href="{% static "stylesheets/application-ie8.css" %}" media="screen" rel="stylesheet" type="text/css" /><![endif]-->
{% endblock %}

{% block before_content %}
    <div class="phase-banner">
        {% switch show_language_switcher %}
        <nav class="language-switcher">
            <ul>
                {% ifequal LANGUAGE_CODE "en" %}
                <li><a rel="alternate" href="{% url 'set_language' %}?lang=cy" hreflang="cy" lang="cy">Cymraeg</a></li>
                {% else %}
                <li><a rel="alternate" href="{% url 'set_language' %}?lang=en" hreflang="en" lang="en">English</a></li>
                {% endifequal %}
            </ul>
        </nav>
        {% endswitch %}
    </div>
{% endblock %}

{% block content %}
    {%  if messages %}
        {% for message in messages %}

            {% if "success" in message.tags %}
            <section class="success-header" role="alert">
                <p class="ticked">{{ message }}</p>
            </section>
            {% endif %}

            {% if "error" in message.tags %}
            <section class="error-summary">
                {% if "session_timeout" in message.tags %}
                <h1 class="heading-medium">{% blocktrans %}Session timeout{% endblocktrans %}</h1>
                <p>{% blocktrans %}Your session has expired, re-enter your details and try again.{% endblocktrans %}</p>
                {% else %}
                {{ message|safe }}
                {% endif %}
            </section>
            {% endif %}

        {% endfor %}
    {% endif %}

    {% block page_content %}{% endblock %}

{% endblock %}

{% block footer_support_links %}
    <li><a href="{% url "terms" %}">{% blocktrans %}Terms and Conditions and Privacy Policy{% endblocktrans %}</a></li>
    <li><a href="{% url "terms" %}#cookies">{% blocktrans %}Cookies{% endblocktrans %}</a></li>
    <li class="clear"><a href="http://www.gov.uk/help">{% blocktrans %}Help{% endblocktrans %}</a></li>
    <li><a href="http://www.gov.uk/contact">{% blocktrans %}Contact{% endblocktrans %}</a></li>
    <li><a href="http://www.gov.uk/cymraeg" lang="cy">{% blocktrans %}Cymraeg{% endblocktrans %}</a></li>
{% endblock %}

{% block javascripts %}
    <script src="{% static "javascripts/application.js" %}" type="text/javascript"></script>

    {% ifequal LANGUAGE_CODE "cy" %}
    <script type="text/javascript">var promptOnChangeMessage = "{% blocktrans %}You have entered some information{% endblocktrans %}";</script>
    {% endifequal %}

    {% if request.session_timeout %}
    <script type="text/javascript">var sessionTimeout = {{ request.session_timeout|stringformat:"i" }};</script>
    {% endif %}

    {% switch enable_a11y_testing %}

        {% if request.session.a11y_testing == "tota11y" %}
        <script src="{% static "javascripts/vendor/tota11y.min.js" %}" type="text/javascript"></script>
        {% endif %}

        {% if request.session.a11y_testing == "google" %}
        <script src="{% static "javascripts/vendor/axs_testing.js" %}" type="text/javascript"></script>
        <script type="text/javascript">
        /**
        * Google Accessibility Developer Tools
        * See https://github.com/GoogleChrome/accessibility-developer-tools
        */
        var configuration = new axs.AuditConfiguration();
        configuration.showUnsupportedRulesWarning = false;

        var results = axs.Audit.run(configuration);
        var output = axs.Audit.createReport(results);
        console.log(output);
        </script>
        {% endif %}

    {% endswitch %}
{% endblock %}


{% block body_end %}
{% if google_analytics_id %}
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', '{{ google_analytics_id }}', {'cookieDomain': 'none'});
    ga('require', 'linkid', 'linkid.js');

    {% if case.urn %}
    ga('set', '&uid', '{{case.urn}}');
    {% endif %}

    ga('set', 'dimension1', '{{ LANGUAGE_CODE }}');

    {% block extra_analytics %}{% endblock extra_analytics %}

    ga('send', 'pageview');
    </script>
{% endif %}
{% endblock %}
