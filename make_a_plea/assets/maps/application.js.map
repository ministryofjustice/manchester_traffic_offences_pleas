{"version":3,"sources":["application.js"],"names":["moj","Modules","Helpers","Events","$","init","x","trigger","log","msg","window","console","dir","obj","devs","m","txt","Conditional","$el","options","this","prototype","defaults","settings","extend","cacheElements","addAriaAttributes","bindEvents","refresh","$conditional","$inputs","data","self","on","toggle","conditionalId","attr","not","each","i","currentAttribute","getInputValue","$input","filter","val","find","currentValue","testExpression","RegExp","match","show","removeAttr","removeProp","hide","prop","_Conditional","Details","addClass","text","prependTo","isOpera","Object","toString","call","opera","openText","$details","closedText","$summaryText","updateState","$summary","$content","$icon","id","index","role","aria-controls","aria-expanded","aria-hidden","aria-live","off","click.details","event","preventDefault","toggleContent","keydown.details","keyCode","click","hasClass","removeClass","toggleClass","_Details","ExternalLinksTracker","eventCategory","eventAction","document","location","pathname","ga","$links","sendGAEvent","href","target","hitCallback","openLink","test","open","_ExternalLinksTracker","FocusHandler","$firstAlert","eq","addTabIndex","focus","$target","setTimeout","tabIndex","undefined","PromptOnChange","message","sessionTimeout","promptOnChangeMessage","currentHash","hashFields","enable","disable","runCheck","serialize","fieldsHaveChanged","isSessionTimeoutRedirect","isEnabled","now","Math","floor","Date","getTime","_PromptOnChange","SelectionButtons","change","is","closest","blur","TemplatedElement","templates","originalText","$element","updateText","getCurrentValue","getText","value","hasOwnProperty","_TemplatedElement","jQuery","fx","remove"],"mappings":"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","file":"../javascripts/application.js","sourcesContent":["(function(){\n  'use strict';\n\n  var moj = {\n\n    Modules: {},\n\n    Helpers: {},\n\n    Events: $({}),\n\n    init: function () {\n      for (var x in moj.Modules) {\n        if (typeof moj.Modules[x].init === 'function') {\n          moj.Modules[x].init();\n        }\n      }\n      // trigger initial render event\n      moj.Events.trigger('render');\n    },\n\n    // safe logging\n    log: function (msg) {\n      if (window && window.console) {\n        window.console.log(msg);\n      }\n    },\n    dir: function (obj) {\n      if (window && window.console) {\n        window.console.dir(obj);\n      }\n    }\n\n  };\n\n  window.moj = moj;\n}());\n\n(function () {\n  'use strict';\n\n  // Invite interested developers to join us\n  moj.Modules.devs = {\n    init: function () {\n      var m = '      ___          ___       ___\\n     /__/\\\\        /  /\\\\     /  /\\\\\\n    |  |::\\\\      /  /::\\\\   /  /:/\\n    |  |:|:\\\\    /  /:/\\\\:\\\\ /__/::\\\\\\n  __|__|:|\\\\:\\\\  /  /:/  \\\\:\\\\\\\\__\\\\/\\\\:\\\\\\n /__/::::| \\\\:\\\\/__/:/ \\\\__\\\\:\\\\  \\\\  \\\\:\\\\\\n \\\\  \\\\:\\\\~~\\\\__\\\\/\\\\  \\\\:\\\\ /  /:/   \\\\__\\\\:\\\\\\n  \\\\  \\\\:\\\\       \\\\  \\\\:\\\\  /:/    /  /:/\\n   \\\\  \\\\:\\\\       \\\\  \\\\:\\\\/:/    /__/:/\\n    \\\\  \\\\:\\\\       \\\\  \\\\::/     \\\\__\\\\/\\n     \\\\__\\\\/        \\\\__\\\\/',\n      txt = '\\n\\nLike what you see? Want to make a difference?'+\n            '\\n\\nFind out how we\\'re making the Ministry Of Justice Digital by Default.'+\n            '\\nhttps://mojdigital.blog.gov.uk/.'+\n            '\\n\\nGet in touch to see what positions are available and see what projects you could be working on.'+\n            '\\nhttps://mojdigital.blog.gov.uk/working-at-moj-ds/';\n      moj.log(m+txt);\n    }\n  };\n}());\n\n/**\n * Conditional form elements reveal\n *\n * Reveal content based on value of related field\n *\n * -----------------------------------------------------------------------\n * Usage:\n *\n * <input type=\"radio\" name=\"trigger_name\" value=\"regex\">\n * <input type=\"radio\" name=\"trigger_name\" value=\"another value\">\n * <div id=\"target_id\" data-conditional=\"trigger_name\" data-conditional-value=\"^regex$\">...</div>\n */\n\n(function() {\n  'use strict';\n\n  window.moj = window.moj || { Modules: {}, Events: $({}) };\n\n  var Conditional = function($el, options) {\n    this.init($el, options);\n    return this;\n  };\n\n  Conditional.prototype = {\n    defaults: {},\n\n    init: function($el, options) {\n      this.settings = $.extend({}, this.defaults, options);\n      this.cacheElements($el);\n      this.addAriaAttributes();\n      this.bindEvents();\n    },\n\n    refresh: function() {\n      this.cacheElements(this.$conditional);\n      this.bindEvents();\n    },\n\n    cacheElements: function($el) {\n      this.$conditional = $el;\n      this.$inputs = $('[name=\"' + $el.data('conditional') + '\"]');\n    },\n\n    bindEvents: function() {\n      var self = this;\n      this.$inputs\n        .on('change.Conditional', function() {\n          self.toggle();\n        });\n      moj.Events\n        .on('render.Conditional', function() {\n          self.toggle();\n        });\n    },\n\n    addAriaAttributes: function() {\n      var conditionalId = this.$conditional.attr('id');\n      this.$inputs.not('[aria-controls*=' + conditionalId + ']').each(function() {\n        $(this).attr('aria-controls', function(i, currentAttribute) {\n          return currentAttribute ? currentAttribute + ' ' + conditionalId : conditionalId;\n        });\n      });\n      this.$conditional.attr('aria-live', 'polite');\n    },\n\n    getInputValue: function($input) {\n      switch($input.attr('type')) {\n        case \"radio\":\n          return $('[name=\"' + $input.attr('name') + '\"]:checked').attr('value');\n\n        case \"checkbox\":\n          return $input.filter(':checked').val();\n\n        default:\n          return $input.val() || $input.find(':selected').attr('value');\n      }\n    },\n\n    toggle: function() {\n      var currentValue = this.getInputValue(this.$inputs),\n          testExpression = new RegExp(this.$conditional.data('conditionalValue'));\n\n      if (currentValue && currentValue.match(testExpression)) {\n        this.$conditional\n          .show()\n          .attr('aria-expanded', 'true')\n          .removeAttr('aria-hidden')\n          .removeProp('hidden');\n      }\n      else {\n        this.$conditional\n          .hide()\n          .attr('aria-expanded', 'false')\n          .attr('aria-hidden', 'true')\n          .prop('hidden', true);\n      }\n    }\n  };\n\n  moj.Modules._Conditional = Conditional;\n\n  moj.Modules.Conditional = {\n    init: function() {\n      return $('[data-conditional]').each(function() {\n        $(this).data('Conditional', new Conditional($(this), $(this).data()));\n      });\n    }\n  };\n\n}());\n\n/**\n * Details Element\n *\n * Replicate <details> functionality that's entirely cross-browser\n * compatible and offers options to update text depending on state\n *\n * -----------------------------------------------------------------------\n * Usage:\n *\n * <div class=\"js-Details [open]\" data-summary-open=\"Alternative text\">\n *   <a class=\"details-trigger\" href=\"#details-content\"><span class=\"summary\">View details</span></a>\n *   <div class=\"details-content\" id=\"details-content\">\n *     Content here\n *   </div>\n * </div>\n *\n * If summaryOpen is set, the summary text is replaced when open. Copy in markup\n * should always be for the closed state.\n */\n(function() {\n  \"use strict\";\n\n  window.moj = window.moj || { Modules: {}, Events: $({}) };\n\n  var Details = function($el, options) {\n    this.init($el, options);\n    return this;\n  };\n\n  Details.prototype = {\n\n    init: function($el, options) {\n\n      $(\"<i>\").addClass(\"arrow arrow-closed\").text(\"\\u25ba\").prependTo($('.details-trigger', $el));\n\n      this.cacheElements($el);\n      this.addAriaAttributes();\n      this.bindEvents();\n\n      this.isOpera = Object.prototype.toString.call(window.opera) == \"[object Opera]\";\n\n      this.openText = this.$details.data(\"summary-open\");\n      this.closedText = this.$summaryText.text();\n\n      this.updateState();\n    },\n\n    cacheElements: function($el) {\n      this.$details = $el;\n      this.$summary = $(\".details-trigger\", $el);\n      this.$summaryText = $(\".summary\", this.$summary);\n      this.$content = $(\".details-content\", $el);\n      this.$icon = $(\"i.arrow\", this.$summary);\n    },\n\n    addAriaAttributes: function() {\n      var id = this.$content.attr(\"id\");\n\n      if (!id) {\n        id = \"js-details-\" + this.$details.index(\".js-Details\");\n        this.$content.attr(\"id\", id);\n      }\n\n      this.$summary.attr({\n        \"role\": \"button\",\n        \"aria-controls\": id,\n        \"aria-expanded\": \"false\"\n      });\n\n      this.$content.attr({\n        \"aria-hidden\": \"true\",\n        \"aria-live\": \"polite\"\n      });\n    },\n\n    bindEvents: function() {\n      var self = this;\n\n      this.$summary.off(\"click.details keydown.details\").on({\n        \"click.details\": function(event) {\n          event.preventDefault();\n          self.toggleContent();\n        },\n        \"keydown.details\": function(event) {\n          if (event.keyCode == 32 || (event.keyCode == 13 && !self.isOpera)) {\n            event.preventDefault();\n            self.$summary.click();\n          }\n        }\n      });\n    },\n\n    updateState: function() {\n      if (this.$details.hasClass(\"open\")) {\n        this.$summary.attr(\"aria-expanded\", \"true\");\n        this.$content.show().removeAttr(\"aria-hidden\").removeProp('hidden');\n        this.$icon.removeClass(\"arrow-closed\").addClass(\"arrow-open\").text(\"\\u25bc\");\n\n        if (this.openText) {\n          this.$summaryText.text(this.openText);\n        }\n      }\n      else {\n        this.$summary.attr(\"aria-expanded\", \"false\");\n        this.$content.hide().attr(\"aria-hidden\", \"true\").prop(\"hidden\", true);\n        this.$icon.removeClass(\"arrow-open\").addClass(\"arrow-closed\").text(\"\\u25ba\");\n\n        if (this.openText) {\n          this.$summaryText.text(this.closedText);\n        }\n      }\n    },\n\n    toggleContent: function() {\n      this.$details.toggleClass(\"open\");\n      this.updateState();\n    }\n  };\n\n  moj.Modules._Details = Details;\n\n  moj.Modules.Details = {\n    init: function() {\n      return $(\".js-Details\").each(function() {\n        $(this).data(\"Details\", new Details($(this), $(this).data()));\n      });\n    }\n  };\n\n}());\n\n(function() {\n  \"use strict\";\n\n  window.moj = window.moj || { Modules: {}, Events: $({}) };\n\n  var ExternalLinksTracker = function($el, options) {\n    this.init($el, options);\n    return this;\n  };\n\n  ExternalLinksTracker.prototype = {\n    defaults: {\n      \"eventCategory\": \"External links\",\n      \"eventAction\": document.location.pathname\n    },\n\n    init: function($el, options) {\n      if (typeof ga === \"undefined\") return;\n\n      this.settings = $.extend({}, this.defaults, options);\n      this.cacheElements($el);\n      this.bindEvents();\n    },\n\n    cacheElements: function($el) {\n      this.$links = $el;\n    },\n\n    bindEvents: function() {\n      var self = this;\n\n      this.$links.on('click', function(event) {\n        event.preventDefault();\n        self.sendGAEvent($(this));\n      });\n    },\n\n    sendGAEvent: function($el) {\n      var self = this,\n          href = $el.attr(\"href\"),\n          target = $el.attr(\"target\");\n\n      ga(\"send\",\n         \"event\",\n         self.settings.eventCategory,\n         href,\n         self.settings.eventAction,\n         {\"hitCallback\": self.openLink(href, target)}\n      );\n    },\n\n    openLink: function(href, target) {\n      if (target && !/^_(self|parent|top)$/i.test(target)) {\n        window.open(href, target);\n      }\n      else {\n        window.location.href = href;\n      }\n    }\n  };\n\n  moj.Modules._ExternalLinksTracker = ExternalLinksTracker;\n\n  moj.Modules.ExternalLinksTracker = {\n    init: function() {\n      $('a[rel=external]').each(function() {\n        $(this).data('ExternalLinksTracker', new ExternalLinksTracker($(this), $(this).data()));\n      });\n    }\n  };\n}());\n\n/**\n * Handle several aspects of focusing on the relevant element\n */\n(function() {\n  'use strict';\n\n  window.moj = window.moj || { Modules: {}, Events: $({}) };\n\n  moj.Modules.FocusHandler = {\n    init: function() {\n      var $firstAlert = $('.success-header, .error-summary').eq(0);\n\n      /**\n       * Set focus to the first alert or success on the page\n       */\n      this.addTabIndex($firstAlert, '0');\n      $firstAlert.focus();\n\n      /**\n       * Set focus to the main content when clicking the 'skip link'\n       */\n      this.addTabIndex($('#content'), '-1');\n      $('.skiplink').on('click', function() { $('#content').focus(); });\n\n      /**\n       * Set focus to the relevant field when clicking an error message in the summary\n       */\n      $('.error-summary [href^=#section_]').on('click', function() {\n        var $target = $($(this).attr('href')).find('input, textarea, select').eq(0);\n        setTimeout(function() { $target.focus(); }, 250);\n      });\n    },\n    addTabIndex: function($el, tabIndex) {\n      if ($el.attr('tabindex') === undefined) {\n        $el.attr('tabindex', tabIndex);\n      }\n    }\n  };\n}());\n\n/**\n * Page exit prompt\n *\n * Prompts the user upon leaving the page if they have changed\n * any data in any form.\n *\n * To set an alternative message or a session timeout timestamp\n * (after which the prompt will be disabled), declare the following\n * variables somewhere in the markup:\n *\n * <script>\n *   var promptOnChangeMessage = \"Alternative message\";\n *   var sessionTimeout = 123456789;\n * </script>\n */\n\n(function(){\n  'use strict';\n\n  window.moj = window.moj || { Modules: {}, Events: $({}) };\n\n  var PromptOnChange = function() {\n    this.init();\n    return this;\n  };\n\n  PromptOnChange.prototype = {\n    init: function() {\n      this.message = \"You have entered some information\";\n      this.sessionTimeout = false;\n\n      if (typeof promptOnChangeMessage === 'string') {\n        this.message = promptOnChangeMessage;\n      }\n      if (typeof sessionTimeout === 'number') {\n        this.sessionTimeout = sessionTimeout;\n      }\n\n      this.currentHash = this.hashFields();\n      this.bindEvents();\n\n      this.enable();\n    },\n\n    bindEvents: function() {\n      var self = this;\n\n      $('form').on('submit', function() {\n        self.disable();\n      });\n\n      // The second event here is used for testing, as there is no\n      // other way of mocking a beforeunload event!\n      $(window).on('beforeunload mock.beforeunload', function() {\n        return self.runCheck();\n      });\n    },\n\n    hashFields: function() {\n      return $('form').serialize();\n    },\n\n    fieldsHaveChanged: function() {\n      return this.hashFields() !== this.currentHash;\n    },\n\n    runCheck: function() {\n      if (this.isSessionTimeoutRedirect()) {\n        this.disable();\n      }\n\n      if (this.isEnabled && this.fieldsHaveChanged()) {\n        return this.message;\n      }\n    },\n\n    enable: function() {\n      this.isEnabled = true;\n    },\n\n    disable: function() {\n      this.isEnabled = false;\n    },\n\n    isSessionTimeoutRedirect: function() {\n      if (this.sessionTimeout) {\n        var now = Math.floor(new Date().getTime() / 1000);\n\n        if (now >= this.sessionTimeout) {\n          return true;\n        }\n      }\n\n      return false;\n    }\n  };\n\n  moj.Modules._PromptOnChange = PromptOnChange;\n\n  moj.Modules.PromptOnChange = {\n    init: function() {\n      return new PromptOnChange();\n    }\n  };\n\n}());\n\n/**\n * Selection Buttons\n *\n * Provides extra focused and selected classes to radio and checkbox\n * form inputs to bring them to default gov.uk styling\n */\n\n(function() {\n  'use strict';\n\n  window.moj = window.moj || { Modules: {}, Events: $({}) };\n\n  moj.Modules.SelectionButtons = {\n    init: function() {\n\n      $('label input[type=radio], label input[type=checkbox]').on({\n        'change': function(){\n          if ($(this).is(':checked')) {\n            if ($(this).is(':radio')) {\n              $(this).closest('form').find('[name=\"' + $(this).attr('name') + '\"]').closest('label').removeClass('selected');\n            }\n            $(this).closest('label').addClass('selected');\n          }\n          else {\n            $(this).closest('label').removeClass('selected');\n          }\n        },\n        'focus': function() {\n          $(this).closest('label').addClass('focused');\n        },\n        'blur': function() {\n          $(this).closest('label').removeClass('focused');\n        }\n      }).trigger('change');\n\n    }\n  };\n\n}());\n\n/**\n * Templated Element\n *\n * Update the text of an element based on the value of a related input field\n *\n * -----------------------------------------------------------------------\n * Usage:\n *\n * <span id=\"templated\">Original content</span>\n *\n * <script>\n * $(function(){\n *   options = {\n *     \"trigger\": \"field_name\",\n *     \"templates\": {\n *       \"value_one\": \"Template one\",\n *       \"value_two\": \"Template two\"\n *     }\n *   }\n *   new moj.Modules.TemplatedElement($('#templated'), options);\n * });\n * </script>\n */\n(function() {\n  'use strict';\n\n  window.moj = window.moj || { Modules: {}, Events: $({}) };\n\n  var TemplatedElement = function($el, options) {\n    this.init($el, options);\n    return this;\n  };\n\n  TemplatedElement.prototype = {\n    defaults: {\n      trigger: ''\n    },\n\n    init: function($el, options) {\n      this.settings = $.extend({}, this.defaults, options);\n\n      this.trigger = this.settings.trigger;\n      this.templates = this.settings.templates;\n      this.originalText = $el.eq(0).text();\n\n      this.cacheElements($el);\n\n      this.bindEvents();\n    },\n\n    cacheElements: function($el) {\n      this.$element = $el;\n      this.$inputs = $(':radio' + this.trigger);\n    },\n\n    bindEvents: function() {\n      var self = this;\n      this.$inputs.on('change.TemplatedElement', function() {\n        self.updateText();\n      });\n      this.updateText();\n    },\n\n    getCurrentValue: function() {\n      return this.$inputs.filter(':checked').val();\n    },\n\n    updateText: function() {\n      this.$element.text(this.getText());\n    },\n\n    getText: function() {\n      var text = this.originalText,\n          value = this.getCurrentValue();\n\n      if (value && this.templates.hasOwnProperty(value)) {\n        text = this.templates[value];\n      }\n\n      return text;\n    }\n  };\n\n  moj.Modules._TemplatedElement = TemplatedElement;\n\n}());\n\n\n$(function() {\n  jQuery.fx.off = true;\n\n  $('.nojs-only[name=split_form]').remove();\n\n  // Handle spacebar use on links with role=button\n  $(document).on('keypress', 'a[role=button]', function(event){\n    if (event.keyCode === 32) {\n      event.preventDefault();\n      event.target.click();\n    }\n  });\n\n  moj.init();\n});\n"]}